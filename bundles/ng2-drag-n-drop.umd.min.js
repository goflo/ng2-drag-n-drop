!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms")):"function"==typeof define&&define.amd?define("ng2-drag-n-drop",["exports","@angular/core","@angular/forms"],t):t(e["ng2-drag-n-drop"]={},e.ng.core,e.ng.forms)}(this,function(e,l,t){"use strict";var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function r(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function c(e){return"string"==typeof e}function p(e){return e!==undefined&&null!==e}var o=function k(e){this.name=e};o.COPY=new o("copy"),o.LINK=new o("link"),o.MOVE=new o("move"),o.NONE=new o("none");var n=function w(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=0),this.imageElement=e,this.x_offset=t,this.y_offset=r,c(this.imageElement)){var a=this.imageElement;this.imageElement=new HTMLImageElement,this.imageElement.src=a}},s=function A(){this.onDragStartClass="dnd-drag-start",this.onDragEnterClass="dnd-drag-enter",this.onDragOverClass="dnd-drag-over",this.onSortableDragClass="dnd-sortable-drag",this.dragEffect=o.MOVE,this.dropEffect=o.MOVE,this.dragCursor="move",this.defaultCursor="pointer"},i=function x(){};function d(){return new g}var g=function P(){this.allowedDropZones=[]};function u(e){return new f(e)}g.decorators=[{type:l.Injectable}];var f=function(){function e(e){this._config=e}return Object.defineProperty(e.prototype,"elem",{get:function(){return this._elem},enumerable:!0,configurable:!0}),e.prototype.markSortable=function(e){p(this._elem)&&this._elem.classList.remove(this._config.onSortableDragClass),p(e)&&(this._elem=e,this._elem.classList.add(this._config.onSortableDragClass))},e}();f.decorators=[{type:l.Injectable}],f.ctorParameters=function(){return[{type:s}]};var D=function(){function e(e,t,r,a){var i=this;this._dragDropService=t,this._config=r,this._cdr=a,this._dragEnabled=!1,this.dropEnabled=!1,this.dropZones=[],this.cloneItem=!1,this._defaultCursor=r.defaultCursor,this._elem=e.nativeElement,this._elem.style.cursor=this._defaultCursor,this._elem.ondragenter=function(e){i._onDragEnter(e)},this._elem.ondragover=function(e){return null!=e.dataTransfer&&(e.dataTransfer.dropEffect=i._config.dropEffect.name),i._onDragOver(e),!1},this._elem.ondragleave=function(e){i._onDragLeave(e)},this._elem.ondrop=function(e){i._onDrop(e)},this._elem.onmousedown=function(e){i._target=e.target},this._elem.ondragstart=function(e){if(!i._dragHandle||i._dragHandle.contains(i._target)){if(i._onDragStart(e),null!=e.dataTransfer){if(e.dataTransfer.setData("text",""),e.dataTransfer.effectAllowed=i.effectAllowed||i._config.dragEffect.name,p(i.dragImage))if(c(i.dragImage))e.dataTransfer.setDragImage(function o(e){var t=new HTMLImageElement;return t.src=e,t}(i.dragImage));else if(function n(e){return"function"==typeof e}(i.dragImage))e.dataTransfer.setDragImage(function s(e){return e()}(i.dragImage));else{var t=i.dragImage;e.dataTransfer.setDragImage(t.imageElement,t.x_offset,t.y_offset)}else if(p(i._config.dragImage)){var r=i._config.dragImage;e.dataTransfer.setDragImage(r.imageElement,r.x_offset,r.y_offset)}else i.cloneItem&&(i._dragHelper=i._elem.cloneNode(!0),i._dragHelper.classList.add("dnd-drag-item"),i._dragHelper.style.position="absolute",i._dragHelper.style.top="0px",i._dragHelper.style.left="-1000px",i._elem.parentElement.appendChild(i._dragHelper),e.dataTransfer.setDragImage(i._dragHelper,e.offsetX,e.offsetY));var a=i._dragHandle?i._dragHandle:i._elem;i._dragEnabled?a.style.cursor=i.effectCursor?i.effectCursor:i._config.dragCursor:a.style.cursor=i._defaultCursor}}else e.preventDefault()},this._elem.ondragend=function(e){i._elem.parentElement&&i._dragHelper&&i._elem.parentElement.removeChild(i._dragHelper),i._onDragEnd(e),(i._dragHandle?i._dragHandle:i._elem).style.cursor=i._defaultCursor}}return Object.defineProperty(e.prototype,"dragEnabled",{get:function(){return this._dragEnabled},set:function(e){this._dragEnabled=!!e,this._elem.draggable=this._dragEnabled},enumerable:!0,configurable:!0}),e.prototype.setDragHandle=function(e){this._dragHandle=e},e.prototype.detectChanges=function(){var e=this;setTimeout(function(){e._cdr&&!e._cdr.destroyed&&e._cdr.detectChanges()},250)},e.prototype._onDragEnter=function(e){this._isDropAllowed(e)&&this._onDragEnterCallback(e)},e.prototype._onDragOver=function(e){this._isDropAllowed(e)&&(e.preventDefault&&e.preventDefault(),this._onDragOverCallback(e))},e.prototype._onDragLeave=function(e){this._isDropAllowed(e)&&this._onDragLeaveCallback(e)},e.prototype._onDrop=function(e){this._isDropAllowed(e)&&(this._preventAndStop(e),this._onDropCallback(e),this.detectChanges())},e.prototype._isDropAllowed=function(e){if((this._dragDropService.isDragged||e.dataTransfer&&e.dataTransfer.files)&&this.dropEnabled){if(this.allowDrop)return this.allowDrop(this._dragDropService.dragData);if(0===this.dropZones.length&&0===this._dragDropService.allowedDropZones.length)return!0;for(var t=0;t<this._dragDropService.allowedDropZones.length;t++){var r=this._dragDropService.allowedDropZones[t];if(-1!==this.dropZones.indexOf(r))return!0}}return!1},e.prototype._preventAndStop=function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},e.prototype._onDragStart=function(e){this._dragEnabled&&(this._dragDropService.allowedDropZones=this.dropZones,this._onDragStartCallback(e))},e.prototype._onDragEnd=function(e){this._dragDropService.allowedDropZones=[],this._onDragEndCallback(e)},e.prototype._onDragEnterCallback=function(e){},e.prototype._onDragOverCallback=function(e){},e.prototype._onDragLeaveCallback=function(e){},e.prototype._onDropCallback=function(e){},e.prototype._onDragStartCallback=function(e){},e.prototype._onDragEndCallback=function(e){},e}();D.decorators=[{type:l.Injectable}],D.ctorParameters=function(){return[{type:l.ElementRef},{type:g},{type:s},{type:l.ChangeDetectorRef}]};var h=function H(e,t,r,a,o){this._dragDropService=t,this._config=r,this._Component=a,this._cdr=o,this._elem=e.nativeElement,this._Component.setDragHandle(this._elem)},b=function(n){function e(e,t,r,a){var o=n.call(this,e,t,r,a)||this;return o.onDragStart=new l.EventEmitter,o.onDragEnd=new l.EventEmitter,o.onDragSuccessCallback=new l.EventEmitter,o._defaultCursor=o._elem.style.cursor,o.dragEnabled=!0,o}return r(e,n),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype._onDragStartCallback=function(e){this._dragDropService.isDragged=!0,this._dragDropService.dragData=this.dragData,this._dragDropService.onDragSuccessCallback=this.onDragSuccessCallback,this._elem.classList.add(this._config.onDragStartClass),this.onDragStart.emit({dragData:this.dragData,mouseEvent:e})},e.prototype._onDragEndCallback=function(e){this._dragDropService.isDragged=!1,this._dragDropService.dragData=null,this._dragDropService.onDragSuccessCallback=null,this._elem.classList.remove(this._config.onDragStartClass),this.onDragEnd.emit({dragData:this.dragData,mouseEvent:e})},e}(D);b.decorators=[{type:l.Directive,args:[{selector:"[dnd-draggable]"}]}],b.ctorParameters=function(){return[{type:l.ElementRef},{type:g},{type:s},{type:l.ChangeDetectorRef}]},b.propDecorators={draggable:[{type:l.Input,args:["dragEnabled"]}],onDragStart:[{type:l.Output}],onDragEnd:[{type:l.Output}],dragData:[{type:l.Input}],onDragSuccessCallback:[{type:l.Output,args:["onDragSuccess"]}],dropzones:[{type:l.Input,args:["dropZones"]}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}],dragImage:[{type:l.Input}],cloneItem:[{type:l.Input}]};var _=function(n){function e(e,t,r,a,o){return n.call(this,e,t,r,a,o)||this}return r(e,n),e}(h);_.decorators=[{type:l.Directive,args:[{selector:"[dnd-draggable-handle]"}]}],_.ctorParameters=function(){return[{type:l.ElementRef},{type:g},{type:s},{type:b},{type:l.ChangeDetectorRef}]};var m=function(n){function e(e,t,r,a){var o=n.call(this,e,t,r,a)||this;return o.onDropSuccess=new l.EventEmitter,o.onDragEnter=new l.EventEmitter,o.onDragOver=new l.EventEmitter,o.onDragLeave=new l.EventEmitter,o.dropEnabled=!0,o}return r(e,n),Object.defineProperty(e.prototype,"droppable",{set:function(e){this.dropEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowdrop",{set:function(e){this.allowDrop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype._onDragEnterCallback=function(e){this._dragDropService.isDragged&&(this._elem.classList.add(this._config.onDragEnterClass),this.onDragEnter.emit({dragData:this._dragDropService.dragData,mouseEvent:e}))},e.prototype._onDragOverCallback=function(e){this._dragDropService.isDragged&&(this._elem.classList.add(this._config.onDragOverClass),this.onDragOver.emit({dragData:this._dragDropService.dragData,mouseEvent:e}))},e.prototype._onDragLeaveCallback=function(e){this._dragDropService.isDragged&&(this._elem.classList.remove(this._config.onDragOverClass),this._elem.classList.remove(this._config.onDragEnterClass),this.onDragLeave.emit({dragData:this._dragDropService.dragData,mouseEvent:e}))},e.prototype._onDropCallback=function(e){var t=e.dataTransfer;(this._dragDropService.isDragged||t&&t.files)&&(this.onDropSuccess.emit({dragData:this._dragDropService.dragData,mouseEvent:e}),this._dragDropService.onDragSuccessCallback&&this._dragDropService.onDragSuccessCallback.emit({dragData:this._dragDropService.dragData,mouseEvent:e}),this._elem.classList.remove(this._config.onDragOverClass),this._elem.classList.remove(this._config.onDragEnterClass))},e}(D);m.decorators=[{type:l.Directive,args:[{selector:"[dnd-droppable]"}]}],m.ctorParameters=function(){return[{type:l.ElementRef},{type:g},{type:s},{type:l.ChangeDetectorRef}]},m.propDecorators={droppable:[{type:l.Input,args:["dropEnabled"]}],onDropSuccess:[{type:l.Output}],onDragEnter:[{type:l.Output}],onDragOver:[{type:l.Output}],onDragLeave:[{type:l.Output}],allowdrop:[{type:l.Input,args:["allowDrop"]}],dropzones:[{type:l.Input,args:["dropZones"]}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}]};var v=function(s){function e(e,t,r,a,o){var n=s.call(this,e,t,r,a)||this;return n._sortableDataService=o,n._sortableData=[],n.dragEnabled=!1,n}return r(e,s),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortableData",{get:function(){return this._sortableData},set:function(e){(this._sortableData=e)instanceof t.FormArray?this.sortableHandler=new C:this.sortableHandler=new y,this.dropEnabled=!!this._sortableData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropzones",{set:function(e){this.dropZones=e},enumerable:!0,configurable:!0}),e.prototype._onDragEnterCallback=function(e){if(this._sortableDataService.isDragged){var t=this._sortableDataService.sortableContainer.getItemAt(this._sortableDataService.index);-1===this.indexOf(t)&&(this._sortableDataService.sortableContainer.removeItemAt(this._sortableDataService.index),0===this._sortableDataService.sortableContainer._sortableData.length&&(this._sortableDataService.sortableContainer.dropEnabled=!0),this.insertItemAt(t,0),(this._sortableDataService.sortableContainer=this)._sortableDataService.index=0),this.detectChanges()}},e.prototype.getItemAt=function(e){return this.sortableHandler.getItemAt(this._sortableData,e)},e.prototype.indexOf=function(e){return this.sortableHandler.indexOf(this._sortableData,e)},e.prototype.removeItemAt=function(e){this.sortableHandler.removeItemAt(this._sortableData,e)},e.prototype.insertItemAt=function(e,t){this.sortableHandler.insertItemAt(this._sortableData,e,t)},e.prototype.replaceItemAt=function(e,t){this.sortableHandler.replaceItemAt(this._sortableData,e,t)},e}(D);v.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable-container]"}]}],v.ctorParameters=function(){return[{type:l.ElementRef},{type:g},{type:s},{type:l.ChangeDetectorRef},{type:f}]},v.propDecorators={draggable:[{type:l.Input,args:["dragEnabled"]}],sortableData:[{type:l.Input}],dropzones:[{type:l.Input,args:["dropZones"]}]};var y=function(){function e(){}return e.prototype.getItemAt=function(e,t){return e[t]},e.prototype.indexOf=function(e,t){return e.indexOf(t)},e.prototype.removeItemAt=function(e,t){e.splice(t,1)},e.prototype.insertItemAt=function(e,t,r){e.splice(r,0,t)},e.prototype.replaceItemAt=function(e,t,r){e.splice(r,1,t)},e}(),C=function(){function e(){}return e.prototype.getItemAt=function(e,t){return e.at(t)},e.prototype.indexOf=function(e,t){return e.controls.indexOf(t)},e.prototype.removeItemAt=function(e,t){e.removeAt(t)},e.prototype.insertItemAt=function(e,t,r){e.insert(r,t)},e.prototype.replaceItemAt=function(e,t,r){e.setControl(r,t)},e}(),S=function(i){function e(e,t,r,a,o,n){var s=i.call(this,e,t,r,n)||this;return s._sortableContainer=a,s._sortableDataService=o,s.onDragSuccessCallback=new l.EventEmitter,s.onDragStartCallback=new l.EventEmitter,s.onDragOverCallback=new l.EventEmitter,s.onDragEndCallback=new l.EventEmitter,s.onDropSuccessCallback=new l.EventEmitter,s.dropZones=s._sortableContainer.dropZones,s.dragEnabled=!0,s.dropEnabled=!0,s}return r(e,i),Object.defineProperty(e.prototype,"draggable",{set:function(e){this.dragEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"droppable",{set:function(e){this.dropEnabled=!!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectallowed",{set:function(e){this.effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectcursor",{set:function(e){this.effectCursor=e},enumerable:!0,configurable:!0}),e.prototype._onDragStartCallback=function(e){this._sortableDataService.isDragged=!0,this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this._sortableDataService.markSortable(this._elem),this._dragDropService.isDragged=!0,this._dragDropService.dragData=this.dragData,this._dragDropService.onDragSuccessCallback=this.onDragSuccessCallback,this.onDragStartCallback.emit(this._dragDropService.dragData)},e.prototype._onDragOverCallback=function(e){if(this._sortableDataService.isDragged){if(this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this._sortableDataService.markSortable(this._elem),this._sortableContainer._elem.classList.add(this._config.onDragOverClass),this._dragDropService.dragData instanceof Array&&this._dragDropService.dragData[0]!==this._sortableContainer.getItemAt(this.index)){var t=this._sortableContainer.getItemAt(this.index),r=this._sortableContainer.indexOf(this._dragDropService.dragData[0]);this._sortableContainer.replaceItemAt(this._dragDropService.dragData[0],this.index),console.log(this._sortableContainer.sortableData),this._sortableContainer.replaceItemAt(t,r)}var a={index:this._sortableDataService.index,dragData:this._dragDropService.dragData};this.onDragOverCallback.emit(a)}},e.prototype._onDragEndCallback=function(e){this._sortableDataService.isDragged=!1,this._sortableDataService.sortableContainer=null,this._sortableDataService.index=null,this._sortableDataService.markSortable(null),this._dragDropService.isDragged=!1,this._dragDropService.dragData=null,this._dragDropService.onDragSuccessCallback=null,this._sortableContainer._elem.classList.remove(this._config.onDragOverClass),this.onDragEndCallback.emit(this._dragDropService.dragData)},e.prototype._onDragEnterCallback=function(e){if(this._sortableDataService.isDragged&&(this._sortableDataService.markSortable(this._elem),this.index!==this._sortableDataService.index||this._sortableDataService.sortableContainer.sortableData!==this._sortableContainer.sortableData)){var t=this._sortableDataService.sortableContainer.getItemAt(this._sortableDataService.index);this._sortableDataService.sortableContainer.removeItemAt(this._sortableDataService.index),0===this._sortableDataService.sortableContainer.sortableData.length&&(this._sortableDataService.sortableContainer.dropEnabled=!0),this._sortableContainer.insertItemAt(t,this.index),this._sortableContainer.dropEnabled&&(this._sortableContainer.dropEnabled=!1),this._sortableDataService.sortableContainer=this._sortableContainer,this._sortableDataService.index=this.index,this.detectChanges()}},e.prototype._onDropCallback=function(e){this._sortableDataService.isDragged&&(this.onDropSuccessCallback.emit(this._dragDropService.dragData),this._dragDropService.onDragSuccessCallback&&this._dragDropService.onDragSuccessCallback.emit(this._dragDropService.dragData),this._sortableContainer.detectChanges())},e}(D);S.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable]"}]}],S.ctorParameters=function(){return[{type:l.ElementRef},{type:g},{type:s},{type:v},{type:f},{type:l.ChangeDetectorRef}]},S.propDecorators={index:[{type:l.Input,args:["sortableIndex"]}],draggable:[{type:l.Input,args:["dragEnabled"]}],droppable:[{type:l.Input,args:["dropEnabled"]}],dragData:[{type:l.Input}],effectallowed:[{type:l.Input,args:["effectAllowed"]}],effectcursor:[{type:l.Input,args:["effectCursor"]}],onDragSuccessCallback:[{type:l.Output,args:["onDragSuccess"]}],onDragStartCallback:[{type:l.Output,args:["onDragStart"]}],onDragOverCallback:[{type:l.Output,args:["onDragOver"]}],onDragEndCallback:[{type:l.Output,args:["onDragEnd"]}],onDropSuccessCallback:[{type:l.Output,args:["onDropSuccess"]}]};var E=function(n){function e(e,t,r,a,o){return n.call(this,e,t,r,a,o)||this}return r(e,n),e}(h);E.decorators=[{type:l.Directive,args:[{selector:"[dnd-sortable-handle]"}]}],E.ctorParameters=function(){return[{type:l.ElementRef},{type:g},{type:s},{type:S},{type:l.ChangeDetectorRef}]};var I=[s,{provide:g,useFactory:d},{provide:f,useFactory:u,deps:[s]}],O=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:I}},e}();O.decorators=[{type:l.NgModule,args:[{declarations:[b,_,m,v,S,E],exports:[b,_,m,v,S,E]}]}],e.providers=I,e.DndModule=O,e.AbstractComponent=D,e.AbstractHandleComponent=h,e.DataTransferEffect=o,e.DragImage=n,e.DragDropConfig=s,e.dragDropServiceFactory=d,e.dragDropSortableServiceFactory=u,e.DragDropData=i,e.DragDropService=g,e.DragDropSortableService=f,e.DraggableComponent=b,e.DraggableHandleComponent=_,e.DroppableComponent=m,e.SortableContainer=v,e.SortableComponent=S,e.SortableHandleComponent=E,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ng2-drag-n-drop.umd.min.js.map
